<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Databases for Developers Exam Project - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="Databases-for-Developers-Exam-Project" data-id="Databases-for-Developers-Exam-Project"><a class="anchor hidden-xs" href="#Databases-for-Developers-Exam-Project" title="Databases-for-Developers-Exam-Project"><span class="octicon octicon-link"></span></a><span>Databases for Developers Exam Project</span></h1><p><strong><span>Authors</span></strong><br>
<em><span>Rúni Vedel Niclasen - cph-rn118</span><br>
<span>Camilla Jenny Valerius Staunstrup - cph-cs340</span></em></p><p><strong><a href="https://github.com/Hold-Krykke-BA/DBD/tree/main/ExamSpringApplication" target="_blank" rel="noopener"><span>Link to Source Code Repository</span></a></strong></p><p><span>June 2nd 2021 - Software Development - Copenhagen Business Academy</span><br>
<span>Characer count: 18173</span></p><h2 id="Table-of-contents" data-id="Table-of-contents"><a class="anchor hidden-xs" href="#Table-of-contents" title="Table-of-contents"><span class="octicon octicon-link"></span></a><span>Table of contents</span></h2><blockquote>
<p><span class="toc"><ul>
<li><a href="#Databases-for-Developers-Exam-Project" title="Databases for Developers Exam Project">Databases for Developers Exam Project</a><ul>
<li><a href="#Table-of-contents" title="Table of contents">Table of contents</a></li>
<li><a href="#Introduction" title="Introduction">Introduction</a><ul>
<li><a href="#Databases" title="Databases">Databases</a></li>
<li><a href="#System-overview" title="System overview">System overview</a></li>
</ul>
</li>
<li><a href="#Product" title="Product">Product</a><ul>
<li><a href="#Postgresql" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis" title="Redis">Redis</a></li>
<li><a href="#Combination-of-databases" title="Combination of databases">Combination of databases</a></li>
</ul>
</li>
<li><a href="#Reflection" title="Reflection">Reflection</a><ul>
<li><a href="#Issues" title="Issues">Issues</a></li>
</ul>
</li>
<li><a href="#Appendix-A-Setup-and-installation" title="Appendix A: Setup and installation">Appendix A: Setup and installation</a><ul>
<li><a href="#Repository" title="Repository">Repository</a></li>
<li><a href="#Java" title="Java">Java</a></li>
<li><a href="#Postgresql1" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j2" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis1" title="Redis">Redis</a></li>
</ul>
</li>
<li><a href="#Appendix-B-Product-requirements" title="Appendix B: Product requirements">Appendix B: Product requirements</a></li>
</ul>
</li>
</ul>
</span></p>
</blockquote><h2 id="Introduction" data-id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a><span>Introduction</span></h2><p><span>For this project we wanted to create a user-driven online forum. As software developer students we spend a lot of time on forums like reddit</span><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup><span>, stackoverflow</span><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup><span> and hackernews</span><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup><span> and have wondered how they are built.</span></p><h3 id="Databases" data-id="Databases"><a class="anchor hidden-xs" href="#Databases" title="Databases"><span class="octicon octicon-link"></span></a><span>Databases</span></h3><p><span>We were assigned to use three databases, so in order to make a semi-realistic use case in combination with a user-driven forum, we had an overall idea of dividing the responsibility as follows:</span></p><ul>
<li><span>A database for caching of the most requested data. The data will be retrievable by keys and does not require relationships.</span></li>
<li><span>A database for most of the user info and especially the user messages/chats. The data will be fast growing and interconnected.</span></li>
<li><span>A database for the forums, posts and comments. The data will be uniform and is easily structured.</span></li>
</ul><p><span>We considered several databases for this project and settled on the following three:</span></p><ul>
<li><strong><span>Redis</span></strong>
<ul>
<li><span>For our project, the key strength of Redis is the in-memory data store and its fast lookups. We can utilize this for caching the data that is queried most often and ease the strain on the other databases.</span></li>
</ul>
</li>
<li><strong><span>Postgresql</span></strong>
<ul>
<li><span>We have wanted to dive deeper in our understanding of relational databases in this project. The post and comments combined with the user interaction is a good way to explore more features, such as functions, procedures and triggers.</span></li>
</ul>
</li>
<li><strong><span>Neo4J</span></strong>
<ul>
<li><span>Our initial plan with Neo4J was to use its advanced features such as fraud detection and general efficiency of the database with growing amounts of connected data between users in the form of chat messages and user relationships </span><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup><span>.</span></li>
</ul>
</li>
</ul><p><span>Other considerations were HBase and MongoDB. We decided against MongoDB primarily because it hasn’t been included in our curriculum for this course. HBase was decided against since the use case in our project would have been the same as Postgres. Due to the size and time constraints of the project we decided that it would be more beneficial to dive deeper in the postgres functionalities rather than adding a third, new database.</span></p><h3 id="System-overview" data-id="System-overview"><a class="anchor hidden-xs" href="#System-overview" title="System-overview"><span class="octicon octicon-link"></span></a><span>System overview</span></h3><p><span>A full overview of our system can be seen in the following diagram. This has been modified slightly during the development and this is the final form.</span></p><p><img src="https://i.imgur.com/SAk1E9h.png" alt=""><br>
<em><span>Full application diagram. A greater resolution image can be seen in our repository </span><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup><span>.</span></em></p><p><span>As part of the development of the system we wrote down our product requirements. These can be found in Appendix B.</span></p><h2 id="Product" data-id="Product"><a class="anchor hidden-xs" href="#Product" title="Product"><span class="octicon octicon-link"></span></a><span>Product</span></h2><p><span>The backend application is developed in Java using Spring as the framework for the REST API. It uses Maven to organize its packages for the database connectors, Bcrypt (password hashing) and Gson (JSON parsing). All databases were deployed on localhost in Docker containers.</span></p><p><span>We have strived to implement best practices for our solution, modifying where necessary and discussing best ways to overcome issues.</span></p><h3 id="Postgresql" data-id="Postgresql"><a class="anchor hidden-xs" href="#Postgresql" title="Postgresql"><span class="octicon octicon-link"></span></a><span>Postgresql</span></h3><p><span>The Postgres database was implemented as in the application diagram</span><sup class="footnote-ref"><a href="#fn5" id="fnref5:1">[5:1]</a></sup><span>. The diagram represents the final version as can also be seen in the following ER diagram produced by the DBeaver client application.</span></p><p><img src="https://i.imgur.com/cbOD0Q1.png" alt=""></p><p><em><span>ER diagram showcasing all tables and relationships in Postgres.</span></em></p><p><span>When designing our schema we aimed to avoid partial or transitive dependencies, as well as ensuring single valued columns and only storing columns with a common domain in the same table</span><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup><span>.</span></p><h4 id="Responsibility" data-id="Responsibility"><a class="anchor hidden-xs" href="#Responsibility" title="Responsibility"><span class="octicon octicon-link"></span></a><span>Responsibility</span></h4><p><span>For this project we decided to put as much responsibility on Postgres as we could. This was done in order to be able to dive deeper into some of the functionalities in a relational database that we would have otherwise let the Java backend handle. This has resulted in a </span><code>PostgresAccessor</code><span> class in Java that only calls functions and procedures. Below you will find an example of how we call the functions and procedures:</span></p><pre><code class="java hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span></div><div class="code"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">upvotePost</span><span class="token punctuation">(</span><span class="token class-name">String</span> postID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PreparedStatement</span> stmt<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">"CALL public.increment_post_karma(?)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> postID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</div></div></code></pre><p><em><span>Example on a simple procedure call in PostgresAccessor.java. Functions are called by </span><code>SELECT * FROM functionName();</code></em></p><p><span>In regards to the stored procedures we are purposefully using a </span><code>PreparedStatement</code><span> instead of a </span><code>CallableStatement</code><span>. This is done to avoid the workaround to be able to use </span><code>CallableStatement</code><span>, as this might be changed in the future</span><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup><span> </span><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup><span>.</span></p><h4 id="Stored-Procedures" data-id="Stored-Procedures"><a class="anchor hidden-xs" href="#Stored-Procedures" title="Stored-Procedures"><span class="octicon octicon-link"></span></a><span>Stored Procedures</span></h4><p><span>We are using the Postgres Stored Procedures for all functionality where we need to set data.</span><br>
<span>As an example we have a procedure for upvoting a </span><code>Comment</code><span>:</span></p><pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> replace <span class="hljs-keyword">PROCEDURE</span> increment_comment_karma(c_id <span class="hljs-type">VARCHAR</span>)
<span class="hljs-keyword">LANGUAGE</span> plpgsql
security definer 
<span class="hljs-keyword">AS</span> $
    <span class="hljs-keyword">BEGIN</span>
        UPDATE public.postcomment
        <span class="hljs-keyword">SET</span> comment_karma<span class="hljs-operator">=</span>comment_karma <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">WHERE</span> comment_id <span class="hljs-operator">=</span> c_id;
    <span class="hljs-keyword">END</span>
$;
</code></pre><p><span>We have implemented the procedures as simply as possible. This results in many specific procedures, instead of a few lengthy ones that are responsible for updating many different tables.</span><br>
<span>As an example we have four procedures to handle upvoting and downvoting </span><code>Comments</code><span> and </span><code>Posts</code><span>, one for each use case, instead of one or two larger procedures that would have a more broad responsibility. This way of implementing the procedures will in our experience be less prone to misuse and misunderstanding.</span></p><h4 id="Stored-Functions" data-id="Stored-Functions"><a class="anchor hidden-xs" href="#Stored-Functions" title="Stored-Functions"><span class="octicon octicon-link"></span></a><span>Stored Functions</span></h4><p><span>For all retrieval of data we are using Stored Functions. We have fairly simple functions that just </span><code>SELECT</code><span> based on an input and a </span><code>WHERE</code><span> clause, and more complex functions like the following, where we are joining multiple tables and using </span><code>GROUP BY</code><span> to eliminate redundancy.</span></p><pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> REPLACE <span class="hljs-keyword">FUNCTION</span> get_FPitem(subID <span class="hljs-type">VARCHAR</span>)
  <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span> (post_title <span class="hljs-type">VARCHAR</span>, 
                post_id <span class="hljs-type">VARCHAR</span>,
                post_url_identifier <span class="hljs-type">VARCHAR</span>,
                post_timestamp <span class="hljs-type">TIMESTAMP</span>,
                user_id <span class="hljs-type">VARCHAR</span>,
                subreddit_name <span class="hljs-type">VARCHAR</span>,
                post_karma <span class="hljs-type">INT</span>,
                comments <span class="hljs-type">BIGINT</span>) <span class="hljs-keyword">AS</span>
$func$
<span class="hljs-keyword">BEGIN</span>
   <span class="hljs-keyword">RETURN</span> QUERY
   
        <span class="hljs-keyword">SELECT</span> p.post_title, p.post_id, p.post_url_identifier, p.post_timestamp, 
            p.user_id, s.subreddit_name, p.post_karma, <span class="hljs-built_in">COUNT</span>(c.comment_id) 
            <span class="hljs-keyword">AS</span> comments
        <span class="hljs-keyword">FROM</span> subreddit s 
        <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> post p <span class="hljs-keyword">ON</span> s.subreddit_id <span class="hljs-operator">=</span> p.subreddit_id 
        <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> postcomment c <span class="hljs-keyword">ON</span> p.post_id <span class="hljs-operator">=</span> c.post_id 
        <span class="hljs-keyword">WHERE</span> s.subreddit_id <span class="hljs-operator">=</span> subID
        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> p.post_id, s.subreddit_name;                   
<span class="hljs-keyword">END</span>
$func$
<span class="hljs-keyword">LANGUAGE</span> plpgsql;

</code></pre><h4 id="Indexing-and-Queryplan" data-id="Indexing-and-Queryplan"><a class="anchor hidden-xs" href="#Indexing-and-Queryplan" title="Indexing-and-Queryplan"><span class="octicon octicon-link"></span></a><span>Indexing and Queryplan</span></h4><p><span>We looked into query plans in order to get a better understanding of what we should create our indexes on, as well as looking at our stored functions and procedures, specifically the </span><code>WHERE</code><span> clauses, as these are the fields being queried the most</span><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup><span>.</span><br>
<span>We generated a plan before and after creating an index based on </span><code>WHERE</code><span> clauses and could see an improvement in the overall execution time. We planned on creating another set of query plans after the creation of large amounts of synthetic data, but time constraints haven’t made it possible for us to do that yet.</span></p><h4 id="Triggers" data-id="Triggers"><a class="anchor hidden-xs" href="#Triggers" title="Triggers"><span class="octicon octicon-link"></span></a><span>Triggers</span></h4><p><span>We created triggers in order to easily keep a users “karma” (sum of upvotes and downvotes on all Posts and Comments) updated. The </span><code>TRIGGER</code><span> is activated on each </span><code>UPDATE</code><span> on the “karma” field for the given table and then calls the trigger function it is associated with. In our case the trigger function updates the sum of the users overall karma for either Posts or Comments.</span></p><pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> REPLACE <span class="hljs-keyword">FUNCTION</span> update_karma_sum_post() <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TRIGGER</span> <span class="hljs-keyword">AS</span>
$BODY$
    <span class="hljs-keyword">BEGIN</span>
        UPDATE reddit_user
        <span class="hljs-keyword">set</span> sum_post_karma<span class="hljs-operator">=</span>sum_post_karma <span class="hljs-operator">+</span> (new.post_karma<span class="hljs-operator">-</span>old.post_karma)
        <span class="hljs-keyword">where</span> user_id<span class="hljs-operator">=</span>new.user_id;
        <span class="hljs-keyword">RETURN</span> <span class="hljs-keyword">new</span>;
    <span class="hljs-keyword">END</span>;
$BODY$
<span class="hljs-keyword">language</span> plpgsql;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TRIGGER</span> trigger_post_karma
    AFTER UPDATE <span class="hljs-keyword">OF</span> post_karma <span class="hljs-keyword">ON</span> post
    <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-type">ROW</span>
    <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">PROCEDURE</span> update_karma_sum_post();
</code></pre><h4 id="Sorting" data-id="Sorting"><a class="anchor hidden-xs" href="#Sorting" title="Sorting"><span class="octicon octicon-link"></span></a><span>Sorting</span></h4><p><span>Simplified our Comments look like this in Postgres:</span></p><pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> postcomment (
  comment_id <span class="hljs-type">VARCHAR</span> (<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  parent_id <span class="hljs-type">VARCHAR</span> (<span class="hljs-number">50</span>),
  comment_timestamp <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  post_id <span class="hljs-type">VARCHAR</span> (<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-comment">-- Some fields and foreign keys removed for brevity</span>
  <span class="hljs-keyword">PRIMARY</span> KEY (comment_id),
  <span class="hljs-keyword">FOREIGN</span> KEY (post_id)
    <span class="hljs-keyword">REFERENCES</span> post (post_id) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> CASCADE, 
  <span class="hljs-keyword">FOREIGN</span> KEY (parent_id)
    <span class="hljs-keyword">REFERENCES</span> postcomment (comment_id) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> CASCADE
);
</code></pre><p><span>Comments can have a parent (if the comment is at the top level the parent is </span><code>NULL</code><span>) and in order to achieve the functionality of sites like reddit</span><sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup><span> we need to be able to sort through all children based on both “timestamp” and “karma”. Comments should be sorted based on “karma” and if any comments on the same level have equal “karma” they should be sorted by time.</span><br>
<img src="https://i.imgur.com/U3213Mm.png" alt=""><br>
<em><span>Example of reddit comment thread with multiple levels of comments.</span></em></p><p><span>In order to achieve this we have implemented a solution</span><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup><span> by Erwin Brandstetter</span><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup><span>, modified to our needs.</span></p><p><span>We use the statement </span><code>WITH RECURSIVE</code><span> to create a flat tree structure from the comments. In the statement there are two </span><code>SELECT</code><span> statements separated by </span><code>UNION ALL</code><span>. The first </span><code>SELECT</code><span> picks out all the top level comments using the </span><code>WHERE</code><span> clause and sorts them with the help of  </span><code>row_number()</code><span> that assigns an integer value to the resultset based on the clause of </span><code>OVER</code><span> which in our case is </span><code>ORDER BY</code><span> “karma” descending and then “timestamp” ascending.</span><br>
<span>The next </span><code>SELECT</code><span> finds all lower level child comments in the same manner as described above. The </span><code>UNION ALL</code><span> combines both result sets into one.</span></p><pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> REPLACE <span class="hljs-keyword">FUNCTION</span> get_Comments_Sorted(postid <span class="hljs-type">VARCHAR</span>)
  <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span> (comment_id <span class="hljs-type">VARCHAR</span>, 
                parent_id <span class="hljs-type">VARCHAR</span>,
                comment_timestamp <span class="hljs-type">TIMESTAMP</span>,
                comment_content <span class="hljs-type">VARCHAR</span>,
                comment_karma <span class="hljs-type">INT</span>,
                post_id <span class="hljs-type">VARCHAR</span>,
                user_id <span class="hljs-type">VARCHAR</span>,
                pppath <span class="hljs-type">INT</span>[],
                pppath_sort <span class="hljs-type">BIGINT</span>[]) <span class="hljs-keyword">AS</span>
$func$
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">RETURN</span> QUERY

    <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> tree <span class="hljs-keyword">AS</span> (
        <span class="hljs-keyword">SELECT</span> pp.comment_id, pp.parent_id, pp.comment_timestamp, 
        pp.comment_content, pp.comment_karma, pp.post_id, pp.user_id, 
        <span class="hljs-keyword">ARRAY</span>[pp.comment_karma] <span class="hljs-keyword">AS</span> path, <span class="hljs-keyword">ARRAY</span>[<span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">OVER</span>
        (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> pp.comment_karma::<span class="hljs-type">int</span> <span class="hljs-keyword">DESC</span>, 
        pp.comment_timestamp::<span class="hljs-type">timestamp</span> <span class="hljs-keyword">ASC</span>)] <span class="hljs-keyword">AS</span> path_sort

        <span class="hljs-keyword">FROM</span>   postcomment pp
        <span class="hljs-keyword">WHERE</span>  pp.post_id <span class="hljs-operator">=</span> postid <span class="hljs-keyword">and</span> pp.parent_id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>

        <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
        <span class="hljs-keyword">SELECT</span> c.comment_id, c.parent_id, c.comment_timestamp,
        c.comment_content, c.comment_karma, c.post_id, c.user_id,
        t.path <span class="hljs-operator">||</span> c.comment_karma, t.path_sort <span class="hljs-operator">||</span> <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">OVER</span> 
        (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> c.comment_karma::<span class="hljs-type">int</span> <span class="hljs-keyword">DESC</span>, c.comment_timestamp::<span class="hljs-type">timestamp</span> <span class="hljs-keyword">ASC</span>)

        <span class="hljs-keyword">FROM</span>   tree t
        <span class="hljs-keyword">JOIN</span>   postcomment c <span class="hljs-keyword">ON</span> t.comment_id <span class="hljs-operator">=</span> c.parent_id
        )
    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
    <span class="hljs-keyword">FROM</span>   tree
    <span class="hljs-keyword">ORDER</span>  <span class="hljs-keyword">BY</span> path_sort;   
<span class="hljs-keyword">END</span>
$func$
<span class="hljs-keyword">LANGUAGE</span> plpgsql;
</code></pre><p><span>With this sorting function all the java backend has to do is create a tree with the list of </span><code>Comments</code><span>. The </span><code>Comments</code><span> will be in order and just need to be assigned to their parents.</span></p><h3 id="Neo4j" data-id="Neo4j"><a class="anchor hidden-xs" href="#Neo4j" title="Neo4j"><span class="octicon octicon-link"></span></a><span>Neo4j</span></h3><p><span>For Neo4j we wanted to explore its inner workings and how its relationships could create interesting queries.</span><br>
<span>A Docker Compose script was adopted from a classmate and rewritten to fit our system.</span><br>
<span>A combined DDL and DML script was created and named </span><code>neo4j.cypher</code><span>. These can be found in the </span><code>~/scripts/</code><span> directory.</span></p><p><span>The database was set up with three clusters and two replicas in </span><em><span>READ</span></em><span> mode.</span></p><table>
<thead>
<tr>
<th><span>Identifier</span></th>
<th><span>Address</span></th>
<th><span>Role</span></th>
<th><span>ROUTING</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>core1</span></td>
<td><span>localhost:7687</span></td>
<td><span>follower</span></td>
<td><span>READ, ROUTE</span></td>
</tr>
<tr>
<td><span>core2</span></td>
<td><span>localhost:7688</span></td>
<td><span>leader</span></td>
<td><span>WRITE, ROUTE</span></td>
</tr>
<tr>
<td><span>core3</span></td>
<td><span>localhost:7689</span></td>
<td><span>follower</span></td>
<td><span>READ, ROUTE</span></td>
</tr>
<tr>
<td><span>readreplica1</span></td>
<td><span>localhost:7690</span></td>
<td><span>read_replica</span></td>
<td><span>READ</span></td>
</tr>
<tr>
<td><span>readreplica2</span></td>
<td><span>localhost:7691</span></td>
<td><span>read_replica</span></td>
<td><span>READ</span></td>
</tr>
</tbody>
</table><p><em><span>Generated using </span><code>:sysinfo</code><span> and </span><code>CALL dbms.routing.getRoutingTable({}, "neo4j") </code></em></p><p><span class="ui-comment-inline-span">This setup follows Neo4j’s </span><em><span class="ui-comment-inline-span">causal clustering</span></em><span class="ui-comment-inline-span"> architecture, ensuring transactional safety, scalability and consistency.</span><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup><br>
<span>It is important to note that the roles and routing of the cores can change using the default setup of Neo4j, so even though </span><em><span>core2</span></em><span> is marked as </span><strong><span>leader</span></strong><span> in the above table, it may not always be.</span><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup></p><p><span>The database scheme was implemented as in the application diagram</span><sup class="footnote-ref"><a href="#fn5" id="fnref5:2">[5:2]</a></sup><span>. There were some slight changes throughout the development period, most notably the inclusion of the Chat node.</span></p><p><img src="https://i.imgur.com/RYUpUSC.png" alt=""><br>
<em><span>Database visualization generated using </span><code>CALL db.schema.visualization()</code></em></p><p><span>These nodes and their relationships are all generated by </span><code>CREATE</code><span> or </span><code>MERGE</code><span> statements, except the </span><code>TTL</code><span> node, which is part of the Neo4j APOC library</span><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup><span>. More specifically, it’s the </span><em><span>Time to Live</span></em><span> procedure</span><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup><span> tied to the </span><code>ttl</code><span> property on </span><code>Session</code><span>.</span></p><p><span>Furthermore, we created indexes and constraints on the relevant properties:</span></p><pre><code class="cypher hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="138"></span>
<span data-linenumber="139"></span>
<span data-linenumber="140"></span>
<span data-linenumber="141"></span>
<span data-linenumber="142"></span>
<span data-linenumber="143"></span>
<span data-linenumber="144"></span>
<span data-linenumber="145"></span>
<span data-linenumber="146"></span>
<span data-linenumber="147"></span>
<span data-linenumber="148"></span></div><div class="code"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">CONSTRAINT</span> userName_UQ IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>
<span class="hljs-keyword">ON</span> (u:<span class="hljs-keyword">User</span>)
ASSERT u.userName <span class="hljs-keyword">IS</span> <span class="hljs-keyword">UNIQUE</span>;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">CONSTRAINT</span> userEmail IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>
<span class="hljs-keyword">ON</span> (u:<span class="hljs-keyword">User</span>)
ASSERT u.userEmail <span class="hljs-keyword">IS</span> <span class="hljs-keyword">UNIQUE</span>;


<span class="hljs-keyword">CREATE</span> INDEX user_IDX_userName IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-keyword">FOR</span> (u:<span class="hljs-keyword">User</span>) <span class="hljs-keyword">ON</span> (u.userName);
<span class="hljs-keyword">CREATE</span> INDEX user_IDX_userID IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-keyword">FOR</span> (u:<span class="hljs-keyword">User</span>) <span class="hljs-keyword">ON</span> (u.userID);
</div></div></code></pre><p><span>Timestamps were all implemented using Neo4js </span><code>localdatetime</code><span>.</span></p><p><span>For accessing the database we used Java driver supplied by Neo4j</span><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup><span>. For a long time we used the </span><code>bolt://</code><span> URI scheme for connecting to the database we specified as leader, but due to the cluster changing leaders</span><sup class="footnote-ref"><a href="#fn13" id="fnref13:1">[13:1]</a></sup><span>, we suddenly couldn’t perform write transactions. This was solved by changing the URI scheme first to </span><code>bolt+routing://</code><span> and finally </span><code>neo4j://</code><span> which enabled server-side routing using Neo4js own routing tables</span><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup><span> </span><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup><span>.</span></p><p><span>The driver was implemented in the </span><code>Neo4jAccessor</code><span> class, which then provides a method to start a </span><code>Session</code><span>, on which you run either a read or a write transaction:</span></p><pre><code class="java hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="416"></span>
<span data-linenumber="417"></span>
<span data-linenumber="418"></span>
<span data-linenumber="419"></span>
<span data-linenumber="420"></span>
<span data-linenumber="421"></span>
<span data-linenumber="422"></span>
<span data-linenumber="423"></span>
<span data-linenumber="424"></span>
<span data-linenumber="425"></span>
<span data-linenumber="426"></span>
<span data-linenumber="427"></span>
<span data-linenumber="428"></span>
<span data-linenumber="429"></span>
<span data-linenumber="430"></span>
<span data-linenumber="431"></span>
<span data-linenumber="432"></span>
<span data-linenumber="433"></span>
<span data-linenumber="434"></span>
<span data-linenumber="435"></span>
<span data-linenumber="436"></span>
<span data-linenumber="437"></span>
<span data-linenumber="438"></span></div><div class="code"><span class="token keyword">public</span> <span class="token class-name">Chat</span> <span class="token class-name">GetOrCreateChat</span><span class="token punctuation">(</span><span class="token class-name">String</span> userNameOne<span class="token punctuation">,</span> <span class="token class-name">String</span> userNameTwo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Session</span> session <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> session<span class="token punctuation">.</span><span class="token function">writeTransaction</span><span class="token punctuation">(</span>tx <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> query <span class="token operator">=</span>
        <span class="token string">"MATCH\n"</span> <span class="token operator">+</span>
        <span class="token string">"(u1:User),\n"</span> <span class="token operator">+</span>
        <span class="token string">"(u2:User)\n"</span> <span class="token operator">+</span>
        <span class="token string">"WHERE u1.userName = $userNameOne "</span> <span class="token operator">+</span> 
        <span class="token string">"AND u2.userName = $userNameTwo \n"</span> <span class="token operator">+</span>
        <span class="token string">"MERGE (u1)-[:PARTICIPATES_IN]-&gt;(ch:Chat)&lt;-[:PARTICIPATES_IN]-(u2) \n"</span> <span class="token operator">+</span>
        <span class="token string">"ON CREATE\n"</span> <span class="token operator">+</span>
        <span class="token string">"SET ch.timestamp = localdatetime(),\n"</span> <span class="token operator">+</span>
        <span class="token string">"ch.chatID = $chatID \n"</span> <span class="token operator">+</span>
        <span class="token string">"RETURN ch;"</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">var</span> res <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token function">parameters</span><span class="token punctuation">(</span>
                <span class="token string">"userNameOne"</span><span class="token punctuation">,</span> userNameOne<span class="token punctuation">,</span>
                <span class="token string">"userNameTwo"</span><span class="token punctuation">,</span> userNameTwo<span class="token punctuation">,</span>
                <span class="token string">"chatID"</span><span class="token punctuation">,</span> <span class="token class-name">CreateUUID</span><span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">single</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"ch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</div></div></code></pre><p><span>This method either gets an existing chat between two users or creates a new one, using the intricate workings of Neo4j’s </span><code>MERGE</code><span> and it’s </span><code>ON CREATE</code><span> clause. This ensures no duplicate records with precautions</span><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup><span>.</span></p><p><span>Worth noting here, is that the driver does not support easy mapping between the returned value and the object we wish to represent. This is manually done in line 435 onward, omitted here for brevity.</span></p><h3 id="Redis" data-id="Redis"><a class="anchor hidden-xs" href="#Redis" title="Redis"><span class="octicon octicon-link"></span></a><span>Redis</span></h3><p><span>The data we needed to cache was data that would be queried often and on reddit</span><sup class="footnote-ref"><a href="#fn1" id="fnref1:2">[1:2]</a></sup><span> the most queried data must be their items on a subreddit frontpage, like the one on the image below.</span></p><p><img src="https://i.imgur.com/SfON8Tg.png" alt=""></p><p><span>For this we created a class in java to represent this </span><code>FPitem</code><span> and we need to cache these items per user, per subreddit.</span><br>
<span>We came up with the following structure for Redis where we have a key-value pair with the </span><code>userID+subredditID</code><span> as the key and a generated </span><code>cacheID</code><span> as the value. This value is then used as the key for the next item in Redis, a range of </span><code>postID</code><span> as values. These </span><code>postID</code><span> are then each the key for a specific </span><code>hset</code><span> containing the actual data required to show the </span><code>FPitem</code><span> and to possible query Postgres for the given post.</span><br>
<span>The keys in the </span><code>hset</code><span> are named for easy mapping and the values are the actual data. This cache has an </span><code>expire</code><span> on all items so they don’t stay in the database indefinitely.</span></p><p><img src="https://i.imgur.com/nAzmQcI.png" alt=""></p><p><span>The </span><code>DataController</code><span> queries the </span><code>RedisAccessor</code><span> for the cache and then checks if the cache has a given length. If it does the cache is returned to the endpoint, if it doesn’t the </span><code>PostgresAccessor</code><span> is queried for the data, the data is then cached in Redis and also returned to the endpoint.</span></p><p><span>Additionally we also wanted to cache a user’s subscriptions to subreddits as this data rarely changes and is shown on each reddit page. This was a much simpler cache since we only need to store a </span><code>hset</code><span> for each user with the </span><code>subredditName</code><span> as key and the </span><code>subredditID</code><span> as value. The key for the </span><code>hset</code><span> is the </span><code>userID+”sub”</code><span>.</span></p><h3 id="Combination-of-databases" data-id="Combination-of-databases"><a class="anchor hidden-xs" href="#Combination-of-databases" title="Combination-of-databases"><span class="octicon octicon-link"></span></a><span>Combination of databases</span></h3><p><span>The </span><code>DataControllerImpl</code><span> class is the controller for the databases and all common logic resides here. As an example the cross-database queries are made from this class and the objects are combined here.</span></p><h2 id="Reflection" data-id="Reflection"><a class="anchor hidden-xs" href="#Reflection" title="Reflection"><span class="octicon octicon-link"></span></a><span>Reflection</span></h2><p><span>If this had been a larger project with a more forgiving time constraint, we would have liked to explore more of the advanced functionalities in especially Neo4j, as well as maybe implementing HBase instead of Postgres.</span></p><h3 id="Issues" data-id="Issues"><a class="anchor hidden-xs" href="#Issues" title="Issues"><span class="octicon octicon-link"></span></a><span>Issues</span></h3><p><span>We have completed a lot of the goals we had for this project, but there are still some to be done. The most pressing issues we haven’t had time to address is:</span></p><ul>
<li><span>Large amounts of synthetic data. We haven’t had the time for this yet.</span></li>
<li><span>Functionality we would have liked to implement at this stage or in the future, for example:</span>
<ul>
<li><span>Awarding “coins” to other users and expanding upon the Neo4J relationships in that regard.</span></li>
<li><span>Caching more data, for example the last ten messages per user.</span></li>
</ul>
</li>
</ul><h4 id="Neo4j1" data-id="Neo4j"><a class="anchor hidden-xs" href="#Neo4j1" title="Neo4j1"><span class="octicon octicon-link"></span></a><span>Neo4j</span></h4><p><span>For Neo4j we wanted to make mapping between the database and Java as easy as possible, especially for making it maintainable. We experimented with a version of Neo4j that is embedded into the Java application</span><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup><span>, unfortunately it was not feasible to implement within the time constraint. The next idea was to implement the Neo4j Java driver, which is used in the final version of the project, but to complement it with the Object-graph mapping (OGM) tool from Neo4j</span><sup class="footnote-ref"><a href="#fn21" id="fnref21">[21]</a></sup><span>. This tool, however, also proved troublesome, as one of its dependencies would not cooperate.</span></p><h4 id="Postgres" data-id="Postgres"><a class="anchor hidden-xs" href="#Postgres" title="Postgres"><span class="octicon octicon-link"></span></a><span>Postgres</span></h4><p><span>It was a challenge to find a solution to the sorting of </span><code>Comments</code><span> in Postgres and we ended up spending a considerable amount of time trying out different approaches before we finally found the solution we described in the </span><a href="#Sorting"><span>Sorting</span></a><span> section.</span></p><h4 id="REST" data-id="REST"><a class="anchor hidden-xs" href="#REST" title="REST"><span class="octicon octicon-link"></span></a><span>REST</span></h4><p><span>We had difficulties adding a REST framework to our project. We suspect it had something to do with the configuration of the framework and how we were exposing the endpoints, since we could deploy the application and see it in the Tomcat manager, but couldn’t access the endpoints. The solution we ended up with was using an, to us, entirely new REST framework.</span></p><h2 id="Appendix-A-Setup-and-installation" data-id="Appendix-A-Setup-and-installation"><a class="anchor hidden-xs" href="#Appendix-A-Setup-and-installation" title="Appendix-A-Setup-and-installation"><span class="octicon octicon-link"></span></a><span>Appendix A: Setup and installation</span></h2><h3 id="Repository" data-id="Repository"><a class="anchor hidden-xs" href="#Repository" title="Repository"><span class="octicon octicon-link"></span></a><span>Repository</span></h3><p><a href="https://github.com/Hold-Krykke-BA/DBD/tree/main/ExamSpringApplication" target="_blank" rel="noopener"><span>https://github.com/Hold-Krykke-BA/DBD/tree/main/ExamSpringApplication</span></a></p><h3 id="Java" data-id="Java"><a class="anchor hidden-xs" href="#Java" title="Java"><span class="octicon octicon-link"></span></a><span>Java</span></h3><p><span>The Java application provides interfaces, controllers and drivers to serve connections to the databases as well as providing a REST API for queries.</span></p><p><span>The application was developed in IntelliJ IDEA and may respond best to that.</span></p><ol>
<li><span>Clone the repository</span></li>
<li><span>Open the </span><code>ExamSpringApplication</code><span> directory as a project and ensure folders are marked appropriately by your IDE.</span></li>
<li><span>Build the project using Maven</span></li>
<li><span>Run the REST API from </span><code>~/src/main/java/holdkrykke/rest/ExamSpringAppApplication.java</code></li>
</ol><p><span>The API responds to GET, PUT, POST and DELETE depending on the endpoint.</span></p><p><span>The accessors in </span><code>~/src/main/java/holdkrykke/dataLayer/dataAccessors</code><span> also have main methods with manual testing not utilizing the REST api.</span></p><h3 id="Postgresql1" data-id="Postgresql"><a class="anchor hidden-xs" href="#Postgresql1" title="Postgresql1"><span class="octicon octicon-link"></span></a><span>Postgresql</span></h3><p><span>To deploy Postgres on localhost simply pull this Docker image:</span><br>
<code>docker run -p 5433:5432 -d -e POSTGRES_PASSWORD=softdbd -e POSTGRES_USER=softdbd -e POSTGRES_DB=soft2021 -v pgdata:/var/lib/postgresql/data postgres</code></p><h3 id="Neo4j2" data-id="Neo4j"><a class="anchor hidden-xs" href="#Neo4j2" title="Neo4j2"><span class="octicon octicon-link"></span></a><span>Neo4j</span></h3><p><span>Setting up Neo4j is done using Docker Compose.</span></p><ol>
<li><span>Open a terminal in </span><code>~/scripts/</code></li>
<li><span>Run </span><code>docker-compose -p dbdexam up</code></li>
<li><span>Insert test data using the </span><em><span>neo4j.cypher</span></em><span> script</span></li>
</ol><p><span>Monitor your cores and replicas closely until setup is complete, as some complications may occur.</span><br>
<span>This happens when the installation of Neo4j libraries and plugins collides with the Neo4j clustering. To fix an exited node, abort from the setup and start the unresolved cores up using </span><code>docker-compose -p dbdexam start</code><span>. The cores will connect to the existing cluster automatically.</span><br>
<span>A command for monitoring logs can be found in the cypher script.</span></p><h3 id="Redis1" data-id="Redis"><a class="anchor hidden-xs" href="#Redis1" title="Redis1"><span class="octicon octicon-link"></span></a><span>Redis</span></h3><p><span>To deploy Redis on localhost simply pull this Docker image:</span><br>
<code>docker run --name redistwo -v redis-data:/data -p 6379:6379 -d redis:alpine</code><span>.</span></p><h2 id="Appendix-B-Product-requirements" data-id="Appendix-B-Product-requirements"><a class="anchor hidden-xs" href="#Appendix-B-Product-requirements" title="Appendix-B-Product-requirements"><span class="octicon octicon-link"></span></a><span>Appendix B: Product requirements</span></h2><p><span>We sketched out the basic requirements at the project start and have since added a few more. They are divided up in functional and non-functional in the following tables.</span></p><h4 id="Functional-requirements" data-id="Functional-requirements"><a class="anchor hidden-xs" href="#Functional-requirements" title="Functional-requirements"><span class="octicon octicon-link"></span></a><span>Functional requirements</span></h4><table>
<thead>
<tr>
<th><span>Req. no.</span></th>
<th><span>Description</span></th>
<th><span>Status</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>1</span></td>
<td><span>See list of posts in given subreddit</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>2</span></td>
<td><span>Create a user account</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>3</span></td>
<td><span>See userinfo, karma &amp; followed subreddits</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>4</span></td>
<td><span>Log in</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>5</span></td>
<td><span>Create a post in a subreddit</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>6</span></td>
<td><span>Comment on a post</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>7</span></td>
<td><span>Comment on a comment</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>8</span></td>
<td><span>See a specific post and all its comments</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>9</span></td>
<td><span>Upvote or downvote a post</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>10</span></td>
<td><span>Upvote or downvote a comment</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>11</span></td>
<td><span>Join a subreddit</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>12</span></td>
<td><span>Leave a subreddit</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>13</span></td>
<td><span>Message another specific user</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>14</span></td>
<td><span>See message-thread</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>15</span></td>
<td><span>Add another user to a friends list</span></td>
<td></td>
</tr>
<tr>
<td><span>16</span></td>
<td><span>Block another user from messages</span></td>
<td></td>
</tr>
</tbody>
</table><h4 id="Non-functional-requirements" data-id="Non-functional-requirements"><a class="anchor hidden-xs" href="#Non-functional-requirements" title="Non-functional-requirements"><span class="octicon octicon-link"></span></a><span>Non-functional requirements</span></h4><table>
<thead>
<tr>
<th><span>Req. no.</span></th>
<th><span>Description</span></th>
<th><span>Status</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>1.1</span></td>
<td><span>Caching of FPitems  per user and subreddit</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>3.1</span></td>
<td><span>Caching user subscriptions</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>8.1</span></td>
<td><span>Sorting of comments should be on the database level</span></td>
<td><span>Completed</span></td>
</tr>
<tr>
<td><span>14.1</span></td>
<td><span>Ordering of messages should be on database level</span></td>
<td><span>Completed</span></td>
</tr>
</tbody>
</table><hr class="footnotes-sep"><section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="http://reddit.com" target="_blank" rel="noopener"><span>reddit.com</span></a> <a href="#fnref1" class="footnote-backref">↩︎</a> <a href="#fnref1:1" class="footnote-backref">↩︎</a> <a href="#fnref1:2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="http://stackoverflow.com" target="_blank" rel="noopener"><span>stackoverflow.com</span></a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://news.ycombinator.com/" target="_blank" rel="noopener"><span>https://news.ycombinator.com/</span></a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://neo4j.com/use-cases/social-network/" target="_blank" rel="noopener"><span>https://neo4j.com/use-cases/social-network/</span></a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://raw.githubusercontent.com/Hold-Krykke-BA/DBD/main/ExamSpringApplication/images/project_diagram.png" target="_blank" rel="noopener"><span>https://raw.githubusercontent.com/Hold-Krykke-BA/DBD/main/ExamSpringApplication/images/project_diagram.png</span></a> <a href="#fnref5" class="footnote-backref">↩︎</a> <a href="#fnref5:1" class="footnote-backref">↩︎</a> <a href="#fnref5:2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://docs.microsoft.com/en-us/office/troubleshoot/access/database-normalization-description" target="_blank" rel="noopener"><span>https://docs.microsoft.com/en-us/office/troubleshoot/access/database-normalization-description</span></a> <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://www.postgresql.org/message-id/4285.1537201440%40sss.pgh.pa.us" target="_blank" rel="noopener"><span>https://www.postgresql.org/message-id/4285.1537201440%40sss.pgh.pa.us</span></a> <a href="#fnref7" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://github.com/pgjdbc/pgjdbc/issues/1413#issuecomment-464851906" target="_blank" rel="noopener"><span>https://github.com/pgjdbc/pgjdbc/issues/1413#issuecomment-464851906</span></a> <a href="#fnref8" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://github.com/Hold-Krykke-BA/DBD/blob/main/ExamSpringApplication/scripts/Queryplan.json" target="_blank" rel="noopener"><span>https://github.com/Hold-Krykke-BA/DBD/blob/main/ExamSpringApplication/scripts/Queryplan.json</span></a> <a href="#fnref9" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://dba.stackexchange.com/a/171248" target="_blank" rel="noopener"><span>https://dba.stackexchange.com/a/171248</span></a> <a href="#fnref10" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn11" class="footnote-item"><p><a href="https://dba.stackexchange.com/users/3684/erwin-brandstetter" target="_blank" rel="noopener"><span>https://dba.stackexchange.com/users/3684/erwin-brandstetter</span></a> <a href="#fnref11" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn12" class="footnote-item"><p><a href="https://neo4j.com/docs/operations-manual/current/clustering/introduction/" target="_blank" rel="noopener"><span>https://neo4j.com/docs/operations-manual/current/clustering/introduction/</span></a> <a href="#fnref12" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn13" class="footnote-item"><p><a href="https://medium.com/neo4j/querying-neo4j-clusters-7d6fde75b5b4" target="_blank" rel="noopener"><span>https://medium.com/neo4j/querying-neo4j-clusters-7d6fde75b5b4</span></a> <a href="#fnref13" class="footnote-backref">↩︎</a> <a href="#fnref13:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn14" class="footnote-item"><p><a href="https://neo4j.com/developer/neo4j-apoc/" target="_blank" rel="noopener"><span>https://neo4j.com/developer/neo4j-apoc/</span></a> <a href="#fnref14" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn15" class="footnote-item"><p><a href="https://neo4j.com/labs/apoc/4.1/graph-updates/ttl/" target="_blank" rel="noopener"><span>https://neo4j.com/labs/apoc/4.1/graph-updates/ttl/</span></a> <a href="#fnref15" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn16" class="footnote-item"><p><a href="https://neo4j.com/developer/java/" target="_blank" rel="noopener"><span>https://neo4j.com/developer/java/</span></a> <a href="#fnref16" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn17" class="footnote-item"><p><a href="https://neo4j.com/docs/operations-manual/current/clustering/internals/#causal-clustering-routing" target="_blank" rel="noopener"><span>https://neo4j.com/docs/operations-manual/current/clustering/internals/#causal-clustering-routing</span></a> <a href="#fnref17" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn18" class="footnote-item"><p><a href="https://neo4j.com/docs/driver-manual/current/client-applications/#driver-connection-uris" target="_blank" rel="noopener"><span>https://neo4j.com/docs/driver-manual/current/client-applications/#driver-connection-uris</span></a> <a href="#fnref18" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn19" class="footnote-item"><p><a href="https://neo4j.com/developer/kb/understanding-how-merge-works/#_a_merge_without_bound_variables_can_create_duplicate_elements" target="_blank" rel="noopener"><span>https://neo4j.com/developer/kb/understanding-how-merge-works/#_a_merge_without_bound_variables_can_create_duplicate_elements</span></a> <a href="#fnref19" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn20" class="footnote-item"><p><a href="https://neo4j.com/docs/java-reference/current/java-embedded/" target="_blank" rel="noopener"><span>https://neo4j.com/docs/java-reference/current/java-embedded/</span></a> <a href="#fnref20" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn21" class="footnote-item"><p><a href="https://neo4j.com/docs/ogm-manual/current/reference/#reference" target="_blank" rel="noopener"><span>https://neo4j.com/docs/ogm-manual/current/reference/#reference</span></a> <a href="#fnref21" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Databases-for-Developers-Exam-Project" title="Databases for Developers Exam Project">Databases for Developers Exam Project</a><ul class="nav">
<li><a href="#Table-of-contents" title="Table of contents">Table of contents</a></li>
<li><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Databases" title="Databases">Databases</a></li>
<li><a href="#System-overview" title="System overview">System overview</a></li>
</ul>
</li>
<li class=""><a href="#Product" title="Product">Product</a><ul class="nav">
<li class=""><a href="#Postgresql" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis" title="Redis">Redis</a></li>
<li><a href="#Combination-of-databases" title="Combination of databases">Combination of databases</a></li>
</ul>
</li>
<li><a href="#Reflection" title="Reflection">Reflection</a><ul class="nav">
<li><a href="#Issues" title="Issues">Issues</a></li>
</ul>
</li>
<li><a href="#Appendix-A-Setup-and-installation" title="Appendix A: Setup and installation">Appendix A: Setup and installation</a><ul class="nav">
<li><a href="#Repository" title="Repository">Repository</a></li>
<li><a href="#Java" title="Java">Java</a></li>
<li><a href="#Postgresql1" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j2" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis1" title="Redis">Redis</a></li>
</ul>
</li>
<li><a href="#Appendix-B-Product-requirements" title="Appendix B: Product requirements">Appendix B: Product requirements</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Databases-for-Developers-Exam-Project" title="Databases for Developers Exam Project">Databases for Developers Exam Project</a><ul class="nav">
<li><a href="#Table-of-contents" title="Table of contents">Table of contents</a></li>
<li><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Databases" title="Databases">Databases</a></li>
<li><a href="#System-overview" title="System overview">System overview</a></li>
</ul>
</li>
<li class=""><a href="#Product" title="Product">Product</a><ul class="nav">
<li class=""><a href="#Postgresql" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis" title="Redis">Redis</a></li>
<li><a href="#Combination-of-databases" title="Combination of databases">Combination of databases</a></li>
</ul>
</li>
<li><a href="#Reflection" title="Reflection">Reflection</a><ul class="nav">
<li><a href="#Issues" title="Issues">Issues</a></li>
</ul>
</li>
<li><a href="#Appendix-A-Setup-and-installation" title="Appendix A: Setup and installation">Appendix A: Setup and installation</a><ul class="nav">
<li><a href="#Repository" title="Repository">Repository</a></li>
<li><a href="#Java" title="Java">Java</a></li>
<li><a href="#Postgresql1" title="Postgresql">Postgresql</a></li>
<li><a href="#Neo4j2" title="Neo4j">Neo4j</a></li>
<li><a href="#Redis1" title="Redis">Redis</a></li>
</ul>
</li>
<li><a href="#Appendix-B-Product-requirements" title="Appendix B: Product requirements">Appendix B: Product requirements</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
